{% extends 'base.html' %} {% block content %}



<div class="col-lg-12 performance-message">
    <div class="jumbotron">
        <h1>Performance</h1>
        <p>Below you can see how well the base game and features are doing. With details on:</p>

        <ul>- Base game status</ul>
        <ul>- Most popular bugs and features</ul>
        <ul>- Current bugs</ul>
        <ul>- Fixed bugs</ul>
        <ul> -New features</ul>







    </div>
</div>


<div class="col-lg-12 performance-panel1">
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6">
            <h1 class="top-5-title-styling">Top 5 features by user likes</h1>
            <table class="table table-bordered table-styling">

                <thead>
                    <tr>
                        <th scope="col" style="color: #ffff52e3;">#</th>
                        <th scope="col" style="text-align: center; color: #ffff52e3;">Feature</th>
                        <th scope="col" style="color: #ffff52e3;">Likes</th>

                    </tr>
                </thead>

                {% for feature in top_features %}
                <tbody>
                    <tr>
                        <td>{{forloop.counter}}</td>
                        <td><a href="{% url 'feature_info' feature.id  %}">{{ feature }}</a></td>
                        <td>{{feature.likes}}</td>
                    </tr>
                </tbody>
                {% endfor %}
            </table>
        </div>

        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6">
            <h1 class="top-5-title-styling">Top 5 Bugs by user upvotes</h1>
            <table class="table table-bordered table-styling">

                <thead>
                    <tr>
                        <th scope="col" style="color: #ffff52e3;">#</th>
                        <th scope="col" style="text-align: center; color: #ffff52e3;">Bug</th>
                        <th scope="col" style="color: #ffff52e3;">Likes</th>

                    </tr>
                </thead>

                {% for bug in top_bugs %}
                <tbody>
                    <tr>
                        <td>{{forloop.counter}}</td>
                        <td><a href="{% url 'bug_info' bug.id  %}">{{ bug }}</a></td>
                        <td>{{bug.upvotes}}</td>
                    </tr>
                </tbody>
                {% endfor %}
            </table>
        </div>
    </div>
</div>

<div class="col-lg-12 performance-panel2">

    <p>Bugs</p>

    <p>GRAPH THAT SHOWS HOW MANY NEW BUGS WERE ADDED IN THE PAST WEEK AND MONTH AND BUG STATUSES</p>
    <div class="row">

        <div class="col-lg-3 col-xl-3">
            <canvas id="numberOfChart" width="400" height="400"></canvas>
        </div>

        <div class="col-lg-3 col-xl-3">
            <canvas id="maxOfChart" width="400" height="400"></canvas>
        </div>
        
        <div class="col-lg-3 col-xl-3">
            <canvas id="statusOfChart" width="400" height="400"></canvas>
        </div>
    
    </div>
</div>

<div class="col-lg-12 performance-panel3">

    <p>HOW MANY BUGS THERE ARE CURRENTLY</p>

    <p> AVERAGE SPEED OF BUG FIX</p>

    <p> HOW OFTEN NEW BUGS ARE ADDED</p>



</div>

<div class="col-lg-12 performance-panel4">

    <p>HOW MANY FEATURES THERE ARE CURRENTLY</p>

    <p>BUGS PER FEATURE GRAPH</p>

</div>

<div class="col-lg-12 performance-panel5">

</div>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.min.js"></script>
<script>
    var endpoint = "{% url 'graph_data' %}"
    var default_data = []
    var labels = []
    $.ajax({
        method: "GET",
        url: endpoint,
        success: function(data) {
            labels1 = data.labels1
            labels2 = data.labels2
            labels3 = data.labels3
            max_values_data = data.max_values
            default_data = data.default
            bugs_feature_status = data.bugs_and_feature_status
            setChart()
            setMaxChart()
            statusChart()
        },
        error: function(error_data) {
            console.log(error_data)
        }
    })

    function setChart() {
        var ctx = document.getElementById("numberOfChart").getContext('2d');
        var myChart = new Chart(ctx, {
            type: 'pie',
            data: {
                labels: labels1,
                datasets: [{
                    label: 'Variety',
                    data: default_data,
                    backgroundColor: [
                        '#FB5E5E',
                        '#5EB8FB',
                        '#FBDE5E',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)',
                        'rgba(255, 159, 64, 0.2)'
                    ],
                    borderColor: [
                        'rgba(255,99,132,1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgba(255, 159, 64, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                }
            }
        });
    }

    function setMaxChart() {
        var ctx = document.getElementById("maxOfChart").getContext('2d');
        var myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels2,
                datasets: [{
                    label: 'Largest amount of upvotes on a bug/feature',
                    data: max_values_data,
                    backgroundColor: [
                        '#FB5E5E',
                        '#5EB8FB',
                        '#FBDE5E',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)',
                        'rgba(255, 159, 64, 0.2)'
                    ],
                    borderColor: [
                        'rgba(255,99,132,1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgba(255, 159, 64, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                }
            }
        });
    }

    function statusChart() {
        var ctx = document.getElementById("statusOfChart").getContext('2d');
        var myChart = new Chart(ctx, {
            type: 'polarArea',
            data: {
                labels: labels3,
                datasets: [{
                    label: 'Status of a bugs and features',
                    data: bugs_feature_status,
                    backgroundColor: [
                        '#FB5E5E',
                        '#FBDE5E',
                        '#5EB8FB',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)',
                        'rgba(255, 159, 64, 0.2)'
                    ],
                    borderColor: [
                        'rgba(255,99,132,1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgba(255, 159, 64, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                }
            }
        });
    }
</script>

{% endblock %}
